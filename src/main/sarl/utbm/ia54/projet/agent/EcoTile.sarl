package utbm.ia54.projet.^agent

import io.sarl.core.Behaviors
import io.sarl.core.DefaultContextInteractions
import io.sarl.core.Initialize
import io.sarl.core.Lifecycle
import io.sarl.util.Scopes
import utbm.ia54.projet.message.AskSynchroMessage
import utbm.ia54.projet.message.LogMessage
import utbm.ia54.projet.message.SynchroResponse

agent EcoTile extends EcoAgent {

	uses Lifecycle, DefaultContextInteractions,Behaviors
	
	var posFinale : Integer
	on Initialize {
		// Initialize parameters
		posFinale = occurrence.parameters.get(0) as Integer
	}
	
	on AskSynchroMessage {
		idLinked = occurrence.id
		pos = occurrence.pos
		emit(new SynchroResponse(ID,posFinale),Scopes.addresses(defaultSpace.getAddress(idLinked)))
		
	}
	
	on SynchroResponse{
		idLinked = occurrence.id
		pos = occurrence.pos
	}
	
	on LogMessage{
		println("Tile : id : " + ID + " | pos " + pos + " | idLinked : " + idLinked + " | posFinale : " + posFinale)
		killMe
	}
}